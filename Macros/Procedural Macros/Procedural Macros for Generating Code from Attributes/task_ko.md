### 속성에서 코드를 생성하기 위한 프로시저 매크로

두 번째 형태의 매크로는 _프로시저 매크로_로, 함수처럼 작동하며 일종의 절차(procedure)입니다. 프로시저 매크로는 코드를 입력으로 받아 해당 코드에 작업을 수행하고, 패턴과 일치시켜 다른 코드로 대체하는 선언적 매크로와는 달리 출력으로 일부 코드를 생성합니다.

프로시저 매크로는 세 가지 유형(사용자 정의 파생, 속성 유사, 함수 유사)이 있으며 모두 비슷한 방식으로 작동합니다.

프로시저 매크로를 생성할 때, 정의는 특수한 크레이트 타입과 함께 별도의 크레이트에 위치해야 합니다. 이는 복잡한 기술적 이유 때문이며, 미래에는 이를 제거하고자 노력 중입니다. 프로시저 매크로를 사용하는 예제는 아래 코드와 같이 보이며, 여기서 `some_attribute`는 특정 매크로를 사용하기 위한 플레이스홀더입니다.

```rust
    use proc_macro;

    #[some_attribute]
    pub fn some_name(input: TokenStream) -> TokenStream {
    }
```

##### 프로시저 매크로 사용 예제

프로시저 매크로를 정의하는 함수는 `TokenStream`을 입력으로 받고, `TokenStream`을 출력으로 생성합니다. `TokenStream` 타입은 Rust와 함께 제공되는 `proc_macro` 크레이트에 의해 정의되어 있으며, 토큰의 시퀀스를 나타냅니다. 매크로의 핵심은 매크로가 작동하는 소스 코드가 입력 `TokenStream`을 구성하며, 매크로가 생성하는 코드는 출력 `TokenStream`이라는 점입니다. 이 함수에는 우리가 어떤 종류의 프로시저 매크로를 생성하고 있는지 지정하는 속성이 부착되어 있습니다. 한 크레이트에서 여러 종류의 프로시저 매크로를 가질 수 있습니다.

이제 다양한 종류의 프로시저 매크로를 살펴보겠습니다. 사용자 정의 파생 매크로(custom derive macro)부터 시작하여 다른 형태의 작은 차이점들을 설명하겠습니다.