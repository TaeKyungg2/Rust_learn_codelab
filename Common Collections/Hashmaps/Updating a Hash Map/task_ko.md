### 해시 맵 업데이트하기

키와 값의 개수는 증가할 수 있지만, 각 키는 한 번에 하나의 값만 가질 수 있습니다. 해시 맵에 저장된 데이터를 변경하려면, 이미 값이 할당된 키를 다루는 방법을 결정해야 합니다. 이전 값을 완전히 무시하고 새 값으로 교체할 수도 있고, 이전 값을 유지하면서 새 값을 무시하며, 키에 값이 *없을 때만* 새 값을 추가할 수도 있습니다. 또는 이전 값과 새 값을 결합할 수도 있습니다. 각각의 방법을 살펴보겠습니다!

#### 값을 덮어쓰기

해시 맵에 키와 값을 삽입한 다음, 동일한 키에 다른 값을 삽입하면 해당 키와 연결된 값이 교체됩니다. 아래 코드에서는 두 번 `insert`를 호출했지만, 해시 맵에는 하나의 키/값 쌍만 존재합니다. 이는 Blue 팀 키의 값을 두 번 삽입했기 때문입니다.

```rust
    use std::collections::HashMap;

    let mut scores = HashMap::new();

    scores.insert(String::from("Blue"), 10);
    scores.insert(String::from("Blue"), 25);

    println!("{:?}", scores);
```

##### 특정 키에 저장된 값을 교체하기

이 코드는 `{"Blue": 25}`를 출력합니다. 원래 값인 `10`은 덮어쓰여졌습니다.

#### 키에 값이 없는 경우에만 값 삽입하기

특정 키에 값이 있는지 확인하고, 값이 없으면 새 값을 삽입하는 경우가 흔합니다. 해시 맵은 이런 작업을 위해 `entry`라는 특수 API를 제공하며, 확인하려는 키를 파라미터로 받습니다. `entry` 메서드의 반환값은 `Entry`라는 열거형으로, 값이 존재할 수도 있고 없을 수도 있는 상태를 나타냅니다. 예를 들어, Yellow 팀 키에 값이 있는지 확인하고, 없으면 값 50을 삽입한다고 가정해봅시다. Blue 팀에도 동일한 작업을 수행합니다. `entry` API를 사용한 코드는 다음과 같습니다:

```rust
    use std::collections::HashMap;

    let mut scores = HashMap::new();
    scores.insert(String::from("Blue"), 10);

    scores.entry(String::from("Yellow")).or_insert(50);
    scores.entry(String::from("Blue")).or_insert(50);

    println!("{:?}", scores);
```

##### 키에 이미 값이 없는 경우에만 삽입하기 위해 entry 메서드 사용하기

`Entry`의 `or_insert` 메서드는 해당 키가 존재하면 해당 키의 값에 대한 가변 참조를 반환하고, 존재하지 않으면 파라미터로 전달된 값을 새 값으로 삽입한 후 이 새 값에 대한 가변 참조를 반환합니다. 이 기법은 직접 로직을 작성하는 것보다 훨씬 간결하며, 빌림 검사기와도 더 잘 작동합니다.

위 코드를 실행하면 `{"Yellow": 50, "Blue": 25}`가 출력됩니다. 첫 번째 `entry` 호출은 Yellow 팀 키에 값이 없으므로 값 50과 함께 키를 삽입합니다. 두 번째 `entry` 호출은 Blue 팀 키에 이미 값 25가 있으므로 해시 맵에 변경을 가하지 않습니다.

#### 기존 값을 기반으로 값 업데이트하기

해시 맵에서 또 다른 일반적인 사용 사례는 키의 값을 조회하고 기존 값을 기반으로 업데이트하는 것입니다. 예를 들어, 다음 예제는 텍스트에서 각 단어가 몇 번 나타나는지 세는 코드를 보여줍니다. 우리는 단어를 키로 하는 해시 맵을 사용하며, 단어를 확인할 때마다 값을 증가시켜 그 단어를 본 횟수를 기록합니다. 처음 보는 단어라면 먼저 값 0을 삽입합니다.

```rust
    use std::collections::HashMap;

    let text = "hello world wonderful world";

    let mut map = HashMap::new();

    for word in text.split_whitespace() {
        let count = map.entry(word).or_insert(0);
        *count += 1;
    }

    println!("{:?}", map);
```

##### 단어와 횟수를 저장하는 해시 맵을 사용하여 단어 발생 횟수 세기

이 코드는 `{"world": 2, "hello": 1, "wonderful": 1}`를 출력합니다. `or_insert` 메서드는 이 키에 대한 값의 가변 참조(`&mut V`)를 반환합니다. 여기서 이 가변 참조를 `count` 변수에 저장한 후, 해당 값을 할당하려면 먼저 `*`를 사용하여 `count`를 역참조해야 합니다. 가변 참조는 `for` 루프가 끝날 때 범위를 벗어나므로, 이러한 모든 변경은 안전하며 빌림 규칙에 의해 허용됩니다.