## `match` 제어 흐름 연산자

Rust에는 `match`라는 매우 강력한 제어 흐름 연산자가 있으며, 값을 일련의 패턴과 비교한 후 일치하는 패턴에 따라 코드를 실행할 수 있습니다. 패턴은 리터럴 값, 변수 이름, 와일드카드, 그리고 많은 다른 요소들로 구성될 수 있습니다. [Rust 책][book]<!-- ignore -->의 18장에서 다양한 패턴의 종류와 그것들이 무엇을 하는지에 대해 다룹니다. `match`의 강력함은 패턴의 표현력과 컴파일러가 모든 가능한 경우를 처리했는지 확인해준다는 점에서 나옵니다.

[book]: https://github.com/rust-lang/book/tree/master/src

`match` 표현식을 동전 분류기와 비슷한 것으로 생각해보세요. 동전이 다양한 크기의 구멍이 있는 트랙을 따라 내려가면서, 각 동전은 맞는 첫 번째 구멍을 통과합니다. 같은 방식으로, 값은 `match`의 각 패턴을 통과하며, 값이 "맞는" 첫 번째 패턴에서 해당 코드 블록으로 떨어져 실행됩니다.

방금 동전을 언급했으니, 이를 예제로 사용해 `match`를 설명해보겠습니다! 알 수 없는 미국 동전을 받아서, 분류기와 유사하게 어떤 동전인지 확인하고 그 가치를 센트 단위로 반환하는 함수를 작성할 수 있습니다. 아래에 그 예시가 나와 있습니다.

```rust
enum Coin {
    Penny,
    Nickel,
    Dime,
    Quarter,
}

fn value_in_cents(coin: Coin) -> u8 {
    match coin {
        Coin::Penny => 1,
        Coin::Nickel => 5,
        Coin::Dime => 10,
        Coin::Quarter => 25,
    }
}
```

#### 열거형(enum)과 열거형의 변종을 패턴으로 사용하는 `match` 표현식

`value_in_cents` 함수 내 `match`를 분석해봅시다. 먼저, `match` 키워드 다음에 표현식을 나열합니다. 여기서는 값 `coin`이 표현식입니다. 이 구문은 `if`와 함께 사용하는 표현식과 매우 비슷하게 보이지만, 큰 차이점이 있습니다. `if`에서는 표현식이 불리언 값을 반환해야 하지만, 여기서는 어떤 유형이든 될 수 있습니다. 이 예에서는 `coin`의 타입이 우리가 1행에서 정의한 `Coin` 열거형입니다.

다음은 `match`의 arm(분기)입니다. arm은 패턴과 코드 두 부분으로 구성됩니다. 첫 번째 arm은 값 `Coin::Penny`이고, 패턴과 실행할 코드를 분리하는 `=>` 연산자를 가지고 있습니다. 이 경우 코드로는 단순히 값 `1`을 반환합니다. 각 arm은 쉼표로 구분됩니다.

`match` 표현식이 실행되면, 결과 값을 각 arm의 패턴과 순서대로 비교합니다. 만약 패턴이 값과 일치하면, 해당 패턴과 연관된 코드가 실행됩니다. 패턴이 값과 일치하지 않으면, 다음 arm으로 넘어갑니다. 이는 동전 분류기와 매우 유사한 동작입니다. 필요한 만큼 arm을 가질 수 있으며, 위 코드 예제에서 `match`는 네 개의 arm을 가지고 있습니다.

각 arm에 포함되는 코드는 표현식이며, 해당 arm의 표현식 결과가 전체 `match` 표현식에서 반환되는 값이 됩니다.

`match` arm의 코드가 짧을 경우에는, 위 코드 예제처럼 중괄호를 사용하지 않는 것이 일반적입니다. 그러나 arm에서 여러 줄의 코드를 실행하려면 중괄호를 사용할 수 있습니다. 예를 들어, 다음 코드는 메서드가 `Coin::Penny`를 인자로 호출될 때마다 "Lucky penny!"를 출력하는 동시에 블록의 마지막 값인 `1`을 반환합니다.

```rust
fn value_in_cents(coin: Coin) -> u8 {
    match coin {
        Coin::Penny => {
            println!("Lucky penny!");
            1
        }
        Coin::Nickel => 5,
        Coin::Dime => 10,
        Coin::Quarter => 25,
    }
}